<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AuroraCryptoBot WebApp</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f5f5f7; }
    header { background: #1e1e2f; color: #fff; padding: 1rem; text-align: center; }
    nav { display: flex; justify-content: space-around; background: #2c2c3e; }
    nav button { flex:1; padding: 1rem; border:none; background:transparent; color:#bbb; cursor:pointer; }
    nav button.active { background: #3a3a4e; color:#fff; }
    section { padding: 1rem; display: none; }
    section.active { display:block; }
    .card { background: #fff; padding:1rem; margin-bottom:1rem; border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,0.1); }
    .button { padding:0.6rem 1.2rem; background:#4a90e2; color:#fff; border:none; border-radius:6px; cursor:pointer; }
    input, select { padding:0.6rem; width:100%; margin-top:0.5rem; margin-bottom:1rem; border:1px solid #ccc; border-radius:4px; }
  </style>
</head>
<body>
  <header>
    <h1>AuroraCryptoBot</h1>
  </header>
  <nav>
    <button id="tab-wallet">–ö–æ—à–µ–ª—ë–∫</button>
    <button id="tab-exchange">–ë–∏—Ä–∂–∞</button>
    <button id="tab-p2p">P2P</button>
    <button id="tab-account">–ê–∫–∫–∞—É–Ω—Ç</button>
  </nav>

  <!-- Wallet -->
  <section id="wallet" class="active">
    <div class="card">
      <h2>–ë–∞–ª–∞–Ω—Å</h2>
      <div id="balance-list">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
    <div class="card">
      <h2>–ü–æ–ø–æ–ª–Ω–∏—Ç—å</h2>
      <label>–û—Ñ–∏—Å:
        <select id="deposit-office">
          <option value="moscow">–ú–æ—Å–∫–≤–∞</option>
          <option value="spb">–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</option>
        </select>
      </label>
      <label>–°—É–º–º–∞:</n        <input type="number" id="deposit-amount" placeholder="1000" />
      </label>
      <button id="deposit-send" class="button">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
    </div>
    <div class="card">
      <h2>–í—ã–≤–æ–¥</h2>
      <p>–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.</p>
    </div>
  </section>

  <!-- Exchange -->
  <section id="exchange">
    <div class="card">
      <h2>–ö—É—Ä—Å –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç</h2>
      <label>–ú–æ–Ω–µ—Ç–∞ (id CoinGecko):
        <input type="text" id="rate-symbol" placeholder="bitcoin" />
      </label>
      <button id="rate-button" class="button">–£–∑–Ω–∞—Ç—å –∫—É—Ä—Å</button>
      <p id="rate-result"></p>
    </div>
    <div class="card">
      <h2>–û–±–º–µ–Ω</h2>
      <label>–ò–∑:</label><input type="text" id="ex-from" placeholder="bitcoin" />
      <label>–í:</label><input type="text" id="ex-to" placeholder="tether" />
      <label>–°—É–º–º–∞:</label><input type="number" id="ex-amount" placeholder="0.5" />
      <button id="ex-button" class="button">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ–±–º–µ–Ω</button>
      <p id="ex-result"></p>
    </div>
  </section>

  <!-- P2P -->
  <section id="p2p">
    <div class="card">
      <h2>P2P-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞</h2>
      <p>–°–ø–∏—Å–æ–∫ –æ—Ñ—Ñ–µ—Ä–æ–≤ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.</p>
    </div>
  </section>

  <!-- Account -->
  <section id="account">
    <div class="card">
      <h2>–ê–∫–∫–∞—É–Ω—Ç</h2>
      <p>–ü—Ä–æ—Ñ–∏–ª—å –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.</p>
    </div>
  </section>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ç–∞–±–∞–º
    const tabs = ['wallet','exchange','p2p','account'];
    tabs.forEach(id => {
      document.getElementById('tab-'+id).onclick = () => {
        tabs.forEach(x=>{
          document.getElementById(x).classList.remove('active');
          document.getElementById('tab-'+x).classList.remove('active');
        });
        document.getElementById(id).classList.add('active');
        document.getElementById('tab-'+id).classList.add('active');
      };
    });

    // Wallet balance (–ª–æ–∫–∞–ª—å–Ω–æ) ‚Äî –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å —á–µ—Ä–µ–∑ —Ç–µ–ª–µ–≥—Ä–∞–º
    document.getElementById('balance-list').innerText = '0 BTC\n0 USDT';

    // –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–∫–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
    document.getElementById('deposit-send').onclick = ()=>{
      const office = document.getElementById('deposit-office').value;
      const amount = document.getElementById('deposit-amount').value;
      tg.sendData(JSON.stringify({ action: 'deposit', office, amount }));
    };

    // –£–∑–Ω–∞—Ç—å –∫—É—Ä—Å
    document.getElementById('rate-button').onclick = async ()=>{
      const sym = document.getElementById('rate-symbol').value;
      const res = await fetch(
        `https://api.coingecko.com/api/v3/simple/price?ids=${sym}&vs_currencies=usd`
      );
      const data = await res.json();
      document.getElementById('rate-result').innerText =
        data[sym]?.usd ? `üí∞ ${sym.toUpperCase()} = ${data[sym].usd} USD` : '–ú–æ–Ω–µ—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞';
    };

    // –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ–±–º–µ–Ω
    document.getElementById('ex-button').onclick = async ()=>{
      const f = document.getElementById('ex-from').value;
      const t = document.getElementById('ex-to').value;
      const a = parseFloat(document.getElementById('ex-amount').value);
      const p1 = await (await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${f}&vs_currencies=usd`)).json();
      const p2 = await (await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${t}&vs_currencies=usd`)).json();
      if(!p1[f]?.usd||!p2[t]?.usd){ document.getElementById('ex-result').innerText='–û—à–∏–±–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤'; return;}  
      const res = a * p1[f].usd / p2[t].usd;
      document.getElementById('ex-result').innerText = `${a} ${f.toUpperCase()} ‚âà ${res.toFixed(6)} ${t.toUpperCase()}`;
    };
  </script>
</body>
</html>
